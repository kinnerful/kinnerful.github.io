<html>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v5.js"></script>

<!-- Load d3-annotation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.js"
  integrity="sha512-OYIn9Tx6AQ/OfeUow7zLScBXV38CqumwIpue7WoR7RczlHJUVU+GqJmQ2Zmq/NrRsMhCN4EDGM4Wp97iTo34Jw=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<style>
	circle {
		fill: lightblue;
		stroke: black;
	}
</style>

<body onload='init()'>
	<svg width=900 height=900>
	</svg>
	<script>
		async function init() {
			msx = d3.scaleLog()
				.domain([10, 150])
				.range([0, 800]);
			msy = d3.scaleLog()
				.domain([150, 10])
				.range([0, 800]);
			margin = 50

			const data = await d3.csv('https://raw.githubusercontent.com/kinnerful/kinnerful.github.io/main/cars2017.csv');
			d3.select('body')
				.select('svg')
				.append('g')
				.attr('transform', 'translate(' + margin + ',' + margin + ')')
				.selectAll('circle').data(data).enter().append('circle')
				.attr('cx', function (d) { return msx(d.AverageCityMPG); })
				.attr('cy', function (d) { return msy(d.AverageHighwayMPG); })
				.attr('r', function (d) { return Number(d.EngineCylinders) + 2; })

			d3.select('svg')
				.append('g')
				.attr('transform', 'translate(' + margin + ',' + margin + ')')
				.call(d3.axisLeft(msy).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")))

			d3.select('svg')
				.append('g')
				.attr('transform', 'translate(' + margin + ',' + (800 + margin) + ')')
				.call(d3.axisBottom(msx).tickValues([10, 20, 50, 100]).tickFormat(d3.format("~s")))
		}
	</script>
</body>

</html>